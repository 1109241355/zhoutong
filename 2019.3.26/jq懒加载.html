<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <head>
        <meta charset="UTF-8">
        <title>图片懒加载-简单</title>
        <style>
            ul,
            li {
                list-style: none;
            }

            .container {
                width: 600px;
                margin: 0 auto;
            }

            .container li {
                float: left;
                margin: 10px 10px;
            }

            .container li img {
                width: 240px;
                height: 180px;
            }

            p {
                float: left;
            }
        </style>
    </head>

<body>
    <ul class="container">
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
        <li><a href="#"><img src="./img/loading.gif" data-src="./img/1.jpg" /></a></li>
    </ul>
    <script src="./jquery-2.0.3/jquery-2.0.3.js"></script>
    <script>
        $(window).scroll(function(){//当页面滚动的时候绑定事件
            $('.container img').each(function () {//遍历所有的img标签
            if (checkShow($(this)) && !isLoaded($(this)) ){
                // 需要写一个checkShow函数来判断当前img是否已经出现在了视野中
                //还需要写一个isLoaded函数判断当前img是否已经被加载过了
                loadImg($(this));//符合上述条件之后，再写一个加载函数加载当前img
            }
        })
        });
        
    function checkShow($img) { // 传入一个img的jq对象
        var scrollTop = $(window).scrollTop();  //即页面向上滚动的距离
        var windowHeight = $(window).height(); // 浏览器自身的高度
        var offsetTop = $img.offset().top;  //目标标签img相对于document顶部的位置

        if (offsetTop < (scrollTop + windowHeight) && offsetTop > scrollTop) { //在2个临界状态之间的就为出现在视野中的
            return true;
        }
        return false;
    }
    function isLoaded ($img) {
        return $img.attr('data-src') === $img.attr('src'); //如果data-src和src相等那么就是已经加载过了
    }
    function loadImg ($img) {
        $img.attr('src',$img.attr('data-src')); // 加载就是把自定义属性中存放的真实的src地址赋给src属性
    }
        // 节流
            function throttle(fn ,time){
            var beforeTime=0;
            return function(){
                var currTime= +new Date();
                var args=arguments;
                var sele=this;
                if(currTime - beforeTime>=time){
                    fn.apply(sele,args);
                    beforeTime=currTime;
                }
            }
        }
        // 防抖
            function debnunce(fn,time){
            var timrer=null;
            return function(){
                var sele=this;
                var args=arguments;
                clearTimeout(timer);
                timrer=setTimeout(function(){
                    fn.apply(sele,args);
                },time);
            }
        }
        // function scrolls(){
        //     var imgDOM=document.querySelectorAll("img");
        //     for(var i=0; i<imgDOM.length;i++){
        //         if(imgDOM[i].getBoundingClientRect().top<window.innerHeight){
        //             imgDOM[i].src=imgDOM[i].getAttribute("data-src");
        //         }
        //     }
        // }
        // window.onscroll=throttle(scrolls,500);
    </script>
</body>
</head>

</html>